# Lerna

Позволяет выносить компоненты приложения в отдельные npm пакеты

## Установка

`npm install -g lerna`

## Установка Angular cli

`npm install -g @angular/cli`

# Создание или использование проекта на angular

`ng new my-project` - создание нового проекта на angular

`git clone <url> .` - клонирование существующего проекта

## Инициализация lerna в проекта

`npx lerna init --independent` - ключ independent означает, что у каждого пакета версия будет меняться независимо от других пакетов, если не указать этот ключ, то при изменении одного пакета версия изменится у всех остальных пакетов. После выполнения данной команды должен обновиться package.json проекта. В секции "devDependencies" добавится зависимость, также появится файл `lerna.json` и каталог `packages`. Файл `lerna.json` содржит настройка сервиса lerna, подробнее здесь https://github.com/lerna/lerna. Каталог `packages` будет содержать компоненты, которые нужно вынести в отдельные npm репозитории. Далее нужно настроить файл `lerna.json` под свои нужды.

# Работа с приватным npm репозиторием

`npm set registry http://<host>:<port>/` - указываем npm, что будет использоваться репозиторий `http://<host>:<port>/`.

`npm adduser --registry http://<host>:<port>/` - добавление пользователя в npm репозиторий, после ввода данной команды потребуется ввести логин, пароль и email пользователя

`npm login` - авторизовываемся в npm репозитории, потребуется ввести логин, пароль и email из предыдущего шага.

## Создание компонента

В каталоге `projects` добавляем каталог для нового компонента, н-р, login. Каталог должен содержать следующие файлы: 

`login.component.ts` - основной класс компонента

`login.component.html` - шаблон компонента

`login.module.ts` - класс модуля

`index.ts` - файл, который экспортирует необходимые файлы

`package.json` - информация о компоненте и его зависимостях

`README.md` - документация

## Публикация пакета

Делаем коммит внесенных изменений

`git add .`

`git commit -m 'create login component'`

`lerna publish` - после ввода данной команды будет выведена информация о версии компонента, чтобы опубликовать изменения нужно подтвердить операцию `y`. После подтверждения изменения попадут в git репозиторий и опубликуется пакет приватном npm рпепозитории.
